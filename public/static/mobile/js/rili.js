var $$=function(t){return"string"==typeof t?document.getElementById(t):t},Class={create:function(){return function(){this.initialize.apply(this,arguments)}}};Object.extend=function(t,n){for(var e in n)t[e]=n[e];return t};var Calendar=Class.create();Calendar.prototype={initialize:function(t,n){this.Container=$$(t),this.Days=[],this.SetOptions(n),this.Year=this.options.Year,this.Month=this.options.Month,this.onToday=this.options.onToday,this.onSignIn=this.options.onSignIn,this.onFinish=this.options.onFinish,this.qdDay=this.options.qdDay,this.isSignIn=!1,this.Draw()},SetOptions:function(t){this.options={Year:(new Date).getFullYear(),Month:(new Date).getMonth()+1,qdDay:null,onToday:function(){},onSignIn:function(){},onFinish:function(){}},Object.extend(this.options,t||{})},PreMonth:function(){var t=new Date(this.Year,this.Month-2,1);this.Year=t.getFullYear(),this.Month=t.getMonth()+1,this.Draw()},NextMonth:function(){var t=new Date(this.Year,this.Month,1);this.Year=t.getFullYear(),this.Month=t.getMonth()+1,this.Draw()},Draw:function(){for(var t=this.qdDay,n=[],e=1,i=new Date(this.Year,this.Month-1,1).getDay();e<=i;e++)n.push("&nbsp;");e=1;for(var s=new Date(this.Year,this.Month,0).getDate();e<=s;e++)n.push(e);var a=document.createDocumentFragment();for(this.Days=[];0<n.length;){var h=document.createElement("tr");for(e=1;e<=7;e++){var o=document.createElement("td");if(o.innerHTML="&nbsp;",0<n.length){var r=n.shift();if(o.innerHTML="<span>"+r+"</span>",0<r&&t.length)for(var l=0;l<t.length;l++)this.Days[r]=o,this.IsSame(new Date(this.Year,this.Month-1,r),t[l])&&this.onToday(o),this.checkSignIn(new Date,t[l])&&this.onSignIn()}h.appendChild(o)}a.appendChild(h)}for(;this.Container.hasChildNodes();)this.Container.removeChild(this.Container.firstChild);if(this.Container.appendChild(a),this.onFinish(),this.isSignIn)return this.isSignIn=!1,this.SignIn()},IsSame:function(t,n){return n=new Date(1e3*n),t.getFullYear()==n.getFullYear()&&t.getMonth()==n.getMonth()&&t.getDate()==n.getDate()},checkSignIn:function(t,n){return n=new Date(1e3*n),t.getFullYear()==n.getFullYear()&&t.getMonth()==n.getMonth()&&t.getDate()==n.getDate()},SignIn:function(){var t=new Date,n=t.getFullYear(),e=t.getMonth()+1;if(n!=this.Year||e!=this.Month)return this.Year=n,this.Month=e,this.isSignIn=!0,this.Draw();for(var i=t.getDate(),s=(new Array,document.getElementById("idCalendar")),a=0;a<s.rows.length;a++)for(var h=0;h<s.rows[a].cells.length;h++)if(i==s.rows[a].cells[h].innerText&&n==this.Year&&e==this.Month)return"onToday"==s.rows[a].cells[h].className?2:(s.rows[a].cells[h].className="onToday",this.qdDay.push(Date.parse(new Date)/1e3),1)}};